---
title: "replace"
---

<ResponseField name="replace(replacement)" />

Replaces code found with [astGrep](./ast-grep). Receives context with every found node.

### Parameters

<ParamField path="replacement" type="string | ReplacementFunction" required>
```ts
import type { SgNode } from '@ast-grep/napi'

interface ReplacementFunctionHelpers {
  getNode: () => SgNode,
  getMatch: (m: string) => SgNode | null,
  getMultipleMatches: (m: string) => SgNode[],
}

type ReplacementFunction =
  (helpers: ReplacementFunctionHelpers) =>
  Promise<string | undefined> | string | undefined
```
If string is provided, it will be used as a replacement for every found node.
If function is provided, it will be called for every found node. It should return a string which will be used as a replacement.

Replacement string can contain matches from search pattern which would be inserted in place.
For example, if search pattern is `console.log($$$A)` and replacement is `console.error($$$A)`, then `console.log('debugging flow')` will be replaced with `console.error('debugging flow')`.

If callback is provided, first argument of callback has few helper functions:
- `getNode()` - returns current found node
- `getMatch(m: string)` - return [single match](https://ast-grep.github.io/guide/pattern-syntax.html#meta-variable)
- `getMultipleMatches(m: string)` - return [multiple matches](https://ast-grep.github.io/guide/pattern-syntax.html#multi-meta-variable)
You can iterate over matches and return new string.
</ParamField>

<RequestExample>
```ts string replacement
import { astGrep } from '@codemod.com/workflow'

await astGrep('console.log($$$A)')
  .replace('console.error($$$A)')
```

```ts before
console.log('debugging flow')
```

```ts after
console.error('debugging flow')
```
</RequestExample>

<ResponseExample>
```ts callback replacement
import { astGrep } from '@codemod.com/workflow'

await astGrep('console.log($$$A)')
  .replace(({ getMultipleMatches }) => {
    const args = getMultipleMatches('A')
      .filter(node => node.kind !== 'arrow_function' && node.kind !== ',')
      
    return `console.error(${args.join(', '))})`
  })
```

```ts before
console.log('debug', () => {})
```

```ts after
console.log('debug')
```
</ResponseExample>
