---
title: "map"
---

<ResponseField name="map(callback)" />

Works similar to `array.map` - maps found code with [astGrep](./ast-grep.mdx).

### Parameters

<ParamField path="callback" type="CallbackFunction" required>
```ts
import type { SgNode } from '@ast-grep/napi'

interface CallbackFunctionHelpers {
  getNode: () => SgNode,
  getMatch: (m: string) => SgNode | null,
  getMultipleMatches: (m: string) => SgNode[],
}

type CallbackFunction =
  (helpers: ReplacementFunctionHelpers) =>
  Promise<string | undefined> | string | undefined
```
It will be called for every found node. It can return anything.
You can use file context inside for example.

Helper functions:
- `getNode()` - returns current found node
- `getMatch(m: string)` - return [single match](https://ast-grep.github.io/guide/pattern-syntax.html#meta-variable)
- `getMultipleMatches(m: string)` - return [multiple matches](https://ast-grep.github.io/guide/pattern-syntax.html#multi-meta-variable)
</ParamField>

<RequestExample>
```ts console.log usages
import { astGrep } from '@codemod.com/workflow'

const allUsagesOfConsoleLog = await astGrep('console.log($$$A)')
    .map(({ getNode }) => getNode().text())
    
console.log(allUsagesOfConsoleLog)
// [
//   "console.log('sample console.log')",
//   "console.log('debugging flow')",
// ]
```
</RequestExample>

<ResponseExample>
```ts console.log usages
import { astGrep, contexts } from '@codemod.com/workflow'

const allUsagesOfConsoleLog = await astGrep('console.log($$$A)')
    .map(({ getNode }) => ({
        code: getNode().text(),
        file: contexts.getFileContext().file,
    }))
    
console.log(allUsagesOfConsoleLog)
// [
//   {
//     code: "console.log('sample console.log')",
//     file: "src/app.js",
//   },
//   {
//     code: "console.log('debugging flow')",
//     file: "src/page.js",
//},
// ]
```
</ResponseExample>
